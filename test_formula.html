<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wet Bulb Formula Validator</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: #f5f5f5;
        }

        h1 {
            color: #333;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .test-case {
            background: white;
            padding: 20px;
            margin: 15px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .test-case h3 {
            margin-top: 0;
            color: #667eea;
        }

        .result {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr 1fr;
            gap: 15px;
            margin: 10px 0;
        }

        .metric {
            padding: 10px;
            background: #f8f9fa;
            border-radius: 5px;
        }

        .metric-label {
            font-size: 12px;
            color: #6c757d;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .metric-value {
            font-size: 24px;
            font-weight: bold;
            color: #212529;
            margin-top: 5px;
        }

        .pass {
            color: #10b981;
        }

        .fail {
            color: #ef4444;
        }

        .expected {
            font-size: 14px;
            color: #6c757d;
            margin-top: 5px;
        }

        .summary {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            font-size: 18px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>üß™ Wet Bulb Temperature Formula Validator</h1>
    <p>Testing the Stull (2011) formula implementation against known reference values.</p>

    <div id="results"></div>
    <div id="summary" class="summary"></div>

    <script>
        // Same calculation as in main app
        function calculateWetBulbTemp(tempCelsius, relativeHumidity) {
            const T = tempCelsius;
            const RH = relativeHumidity;

            const Tw = T * Math.atan(0.151977 * Math.sqrt(RH + 8.313659))
                     + Math.atan(T + RH)
                     - Math.atan(RH - 1.676331)
                     + 0.00391838 * Math.pow(RH, 3/2) * Math.atan(0.023101 * RH)
                     - 4.686035;

            return Tw;
        }

        // Test cases with expected values (approximately)
        // These are based on psychrometric calculations
        const testCases = [
            {
                name: "Comfortable conditions",
                temp: 25,
                humidity: 50,
                expected: 17.5,
                tolerance: 1.0,
                description: "Typical comfortable indoor conditions"
            },
            {
                name: "Warm and moderately humid",
                temp: 30,
                humidity: 50,
                expected: 21.5,
                tolerance: 1.0,
                description: "Starting to feel warm"
            },
            {
                name: "Hot and humid",
                temp: 35,
                humidity: 60,
                expected: 27.1,
                tolerance: 1.0,
                description: "Approaching dangerous conditions"
            },
            {
                name: "Very humid but moderate temp",
                temp: 25,
                humidity: 80,
                expected: 22.7,
                tolerance: 1.0,
                description: "High humidity makes it feel much worse"
            },
            {
                name: "Hot but dry",
                temp: 40,
                humidity: 30,
                expected: 25.6,
                tolerance: 1.0,
                description: "Hot but evaporative cooling still works"
            },
            {
                name: "Extreme danger threshold",
                temp: 35,
                humidity: 100,
                expected: 35.0,
                tolerance: 1.0,
                description: "No evaporative cooling possible - lethal conditions"
            },
            {
                name: "Cold and dry",
                temp: 10,
                humidity: 40,
                expected: 5.5,
                tolerance: 1.0,
                description: "Cold conditions"
            },
            {
                name: "Freezing",
                temp: 0,
                humidity: 50,
                expected: -2.5,
                tolerance: 1.5,
                description: "Below freezing"
            }
        ];

        function runTests() {
            const resultsDiv = document.getElementById('results');
            let passed = 0;
            let failed = 0;

            testCases.forEach(test => {
                const calculated = calculateWetBulbTemp(test.temp, test.humidity);
                const difference = Math.abs(calculated - test.expected);
                const isPassing = difference <= test.tolerance;

                if (isPassing) passed++;
                else failed++;

                const div = document.createElement('div');
                div.className = 'test-case';
                div.innerHTML = `
                    <h3>${test.name} ${isPassing ? '‚úÖ' : '‚ùå'}</h3>
                    <p>${test.description}</p>
                    <div class="result">
                        <div class="metric">
                            <div class="metric-label">Temperature</div>
                            <div class="metric-value">${test.temp}¬∞C</div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">Humidity</div>
                            <div class="metric-value">${test.humidity}%</div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">Calculated WBT</div>
                            <div class="metric-value ${isPassing ? 'pass' : 'fail'}">
                                ${calculated.toFixed(2)}¬∞C
                            </div>
                            <div class="expected">Expected: ${test.expected}¬∞C ¬±${test.tolerance}</div>
                        </div>
                        <div class="metric">
                            <div class="metric-label">Difference</div>
                            <div class="metric-value ${isPassing ? 'pass' : 'fail'}">
                                ${difference.toFixed(2)}¬∞C
                            </div>
                            <div class="expected">Tolerance: ${test.tolerance}¬∞C</div>
                        </div>
                    </div>
                `;
                resultsDiv.appendChild(div);
            });

            const summaryDiv = document.getElementById('summary');
            const passRate = ((passed / testCases.length) * 100).toFixed(0);
            summaryDiv.innerHTML = `
                Test Results: ${passed} passed, ${failed} failed out of ${testCases.length} tests (${passRate}% pass rate)
                <br>
                ${failed === 0 ? 'üéâ All tests passed! Formula implementation is validated.' : '‚ö†Ô∏è Some tests failed. Review the formula implementation.'}
            `;
            summaryDiv.style.color = failed === 0 ? '#10b981' : '#ef4444';
        }

        // Run tests on page load
        runTests();
    </script>
</body>
</html>
